
# AvaBox 2019-2022

«Аватария» — это ролевая игра-симулятор, виртуальный мир, где сбываются мечты.

В игре игроку даётся в безвозмездное пользование квартира, которую можно обставлять по своему вкусу, устраивать в ней вечеринки и приглашать друзей в гости. Также доступно взаимодействие с другими игроками в режиме онлайн: обмен предметами, объятия и поцелуи, пинки и пощёчины, бои на подушках и многое другое.

Ещё в «Аватарии» есть развитая система социальных отношений, включая возможность сыграть настоящую свадьбу. Также в игре большое количество публичных игровых локаций с уникальными особенностями: парк, ночной клуб, сквер, кафе, двор, салон красоты.

Кроме того, в игре можно создавать полезные предметы и подарки в своей собственной мастерской.

## AvaCity

Написанные модули для самого [популярного сервера](https://github.com/AvaCity/avacity-async) по игре «Аватария»

## Особенности сборки

Реализовано:

- Защита от взлома конфигурации
- Защита от бага aiohttp
- Бот ВК показывающий профиль
- Бот ВК показывающий модерацию
- Бот ВК показывающий донатеров
- Бот ВК показывающий PIN клана
- Автооплата UnitPay
- Обмен деревьев
- Система трейдов
- Акция FirstApril2020
- Акция Halloween2020
- Акция NewYear2021
- Акция AvaBirthday2021
- Акция StVal2020
- Полностью рабочий телефон
- Полностью рабочая почта
- Рабочий логгер за модерацией
- Рабочая выдача подарков
- Рабочая выдача угощений
- Рабочий паспорт-декор
- Рабочий чат-декор
- Рабочая покупка подарков
- Рабочее открытие подарков
- Рабочие промокоды
- Рабочая активность за действия
- Рабочая система репутации
- Покупка рубинов для клана
- Покупка клан коинов
- Покупка энергии
- Бои подушками
- Дуэль на серфах
- Дуэль на сноубордах
- Гонки в каньоне
- Рабочее использование кофе и энергетика
- Исправлен баг с пропажей торта на лице
- Исправлен баг с входом в квартиру NPC
- Исправленный новостной вестник

## Особенность акций

- Акций сделано много, чтобы использовать выбранную акцию нужно прописать её в Campaign и Descriptor
- Инжектирование акции при входе в квартиру можно отредактировав **_perform_login** функцию

## Особенность веб-части

В целях защиты от DDoS-атак на TCP, советую использовать веб-сервер nginx, а не apache.  
Изначально у игроков нет вип-статуса на сервере, автооплата работает через UnitPay:

```
conf = {
    'sums': [цена],
    'projectName': '',
    'projectId': '',
    'publicKey': '',
    'secret-key': ''
}
```

Важно отметить, что не имея вип игрок не может пользоваться слотами и прочими функциями, отключить это можно отредактировав **get_user_info** функцию

## Установка и запуск

Предупреждение: работа на Windows не гарантируется и поддерживать её не собираемся. ОДНАКО: запустить сервер на винде можно без особых проблем и для этого даже не нужно править код.

Из зависимостей за пределами питона вам нужен только Redis. Просто устанавливаете и запускаете его.

### Установить необходимые модули:

```
$ pip3 install --user -r requirements.txt
```

Сервер работает в полностью автономном режиме и поэтому нужно загрузить все файлы игры (возможно потребуется выполнить команду несколько раз):

```
$ python3 update.py
```

Запускаем в разных терминалах или, например, в tmux вебсервер и, собственно, игровой сервер:

- терминал 1: `$ python3 web.py`
- терминал 2: `$ python3 server.py`

Готово, по умолчанию вебсервер работает по адресу http://127.0.0.1:8080
